services:
  unifi:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        UNIFI_DEB: unifi_sysvinit_all.deb
    image: unifi:9.5.21
    container_name: unifi-controller
    restart: unless-stopped
    ports:
      # ESSENTIELL für Device Adoption (basierend auf funktionierender lokaler Installation):
      - "8080:8080/tcp" # Device/controller communication (Inform-Protokoll) - WICHTIG!
      - "8443:8443/tcp" # Controller GUI/API
      - "10001:10001/udp" # AP discovery - WICHTIG!
      # Weitere Ports (wie in lokaler Installation):
      - "8880:8880/tcp" # HTTP portal redirection
      - "8843:8843/tcp" # HTTPS portal redirection
      - "1900:1900/udp" # SSDP (UPnP) - für Device Discovery
      # Ports weggelassen (bereits belegt auf Host):
      # - "3478:3478/udp"  # STUN (bereits belegt)
      # - "5514:5514/udp"  # Syslog (bereits belegt)
      # - "6789:6789/tcp"  # Speed test (bereits belegt)
      # - "8081:8081/tcp"  # Nicht benötigt, verwenden 8080
    volumes:
      - unifi-data:/usr/lib/unifi/data
    environment:
      - TZ=Europe/Berlin
    networks:
      - unifi-network

volumes:
  unifi-data:
    driver: local

networks:
  unifi-network:
    driver: bridge
